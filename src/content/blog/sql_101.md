---
title: 'SQL 101'
description: 'Lorem ipsum dolor sit amet'
pubDate: 'Sep 26 2024'
heroImage: '/blog-placeholder-1.jpg'
---

# SQL

**SQL is** Structured query language (SQL) is a programming language for storing and processing information in a relational database

**SQL: `Query -> Data base -> Result`**

**Data Types**¬†‡∫ó‡∫µ‡ªà‡ªÄ‡∫Æ‡∫ª‡∫≤‡ªÉ‡∫ä‡ªâ‡∫Å‡∫±‡∫ô‡ªÉ‡∫ô SQL ‡∫à‡∫∞‡∫°‡∫µ‡∫¢‡∫π‡ªà 4 ‡∫õ‡∫∞‡ªÄ‡∫û‡∫î‡∫´‡∫º‡∫±‡∫Å‡ªÜ‡∫Ñ‡∫∑

- INT ‡∫ï‡∫ª‡∫ß‡ªÄ‡∫•‡∫Å‡∫à‡∫≥‡∫ô‡∫ß‡∫ô‡ªÄ‡∫ï‡∫±‡∫°
- REAL (real number ‡∫´‡∫º‡∫∑ float ‡∫ï‡∫ª‡∫ß‡ªÄ‡∫•‡∫Å‡∫ó‡∫µ‡ªà‡∫°‡∫µ‡∫ó‡∫ª‡∫î‡∫™‡∫∞‡∫ô‡∫¥‡∫ç‡∫ª‡∫°‡ªÑ‡∫î‡ªâ)
- TEXT ‡∫ï‡∫ª‡∫ß‡ªú‡∫±‡∫á‡∫™‡∫∑
- DATE ‡∫ß‡∫±‡∫ô‡∫ó‡∫µ‡ªÄ‡∫î‡∫∑‡∫≠‡∫ô‡∫õ‡∫µ

---

### Basic SQL

> Create table : `CREATE TABLE name(name1 dataType,[name2 dataType])`
> 
> 
> ```sql
> CREATE TABLE employee(
> 	id int UNIQUE,
>   	name text,
>   	department text,
>   	position text,
>   	saraly real
> )
> ```
> 

> Insert Data to table: `INSERT INTO nameOfTable VALUE (data)`
> 
> 
> ```sql
> INSERT INTO employee VALUES
> 	(1, 'Emily','Marketing', 'CEO', 100000),
>     (2, 'Jonh','Marketing', 'VP', 85000),
>     (3, 'Mark','Sales', 'Manager', 60000),
> 	(4, 'Marry', 'IT', 'Senior Manager', 88000),
>     (5, 'None', 'IT', 'Manager', 680000)
> ```
> 

> Delete table: `DROP TABLE`
> 

‡ªÄ‡∫Æ‡∫ª‡∫≤‡∫Ç‡∫Ω‡∫ô¬†`SELECT`¬†‡ªÄ‡∫û‡∫∑‡ªà‡∫≠‡∫î‡∫∂‡∫á‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô (‡∫ñ‡∫±‡∫ô‡∫ó‡∫µ‡ªà‡ªÄ‡∫Æ‡∫ª‡∫≤‡∫ï‡ªâ‡∫≠‡∫á‡∫Å‡∫≤‡∫ô) ‡∫à‡∫≤‡∫Å table ‡∫´‡∫º‡∫±‡∫á‡∫à‡∫≤‡∫Å‡∫ó‡∫µ‡ªà‡ªÄ‡∫Æ‡∫ª‡∫≤‡ªÑ‡∫î‡ªâ‡ªÄ‡∫Æ‡∫±‡∫î business requirements ‡∫à‡∫≤‡∫Å users ‡ªÅ‡∫•‡ªâ‡∫ß,‡ªÄ‡∫Æ‡∫ª‡∫≤‡∫à‡∫∞‡∫Ç‡∫Ω‡∫ô¬†`SQL`¬†query ‡ªÄ‡∫û‡∫∑‡ªà‡∫≠ gather data ‡∫™‡∫≥‡∫•‡∫±‡∫ö‡ªÇ‡∫õ‡∫£‡ªÄ‡∫à‡∫±‡∫Å‡∫ô‡∫±‡ªâ‡∫ô‡ªÜ. ‡∫ï‡∫ª‡∫ß‡∫¢‡ªà‡∫≤‡∫á query ‡ªÄ‡∫ä‡∫±‡ªà‡∫ô

`SELECT * FROM customers;`

```sql
/*SELECT id, name, saraly FROM employee */
/*SELECT * FROM employee 
WHERE saraly>80000*/

SELECT *FROM employee
WHERE department IN ('Maketing','IT')
```

> Create new column :
> 
> 
> ```sql
> SELECT
> 	  name, 
>     saraly,
>     **saraly*1.15 AS new_salary,**
>     LOWER(name) || '@company.com' As company_email
> FROM employee
> ```
> 

> Update Data :
> 
> 
> ```sql
> UPDATE employee 
> SET department = 'Marketing'
> WHERE department = 'Maketing';
> SELECT * FROM employee
> ```
> 

> Delete Record :
> 
> 
> ```sql
> DELETE FROM employee
> WHERE id IN (2,4);
> SELECT * FROM employee
> ```
> 

> Alter :
> 
> 
> ```sql
> --ALTER TABLE employee RENAME to MyEmployee
> 
> ALTER TABLE MyEmployee
> ADD email TExt;
> 
> UPDATE MyEmployee
> SET email = 'admin@company.com';
> 
> SELECT * FROM MyEmployee
> ```
> 

> Create Backup :
> 
> 
> ```sql
> CREATE TABLE MyEmployee_Backup AS
> SELECT * FROM MyEmployee;
> ```
> 

[SQL 101.db](SQL%202bafed0de75d494cab3d47e07832dd88/SQL_101.db)

- Using Create, Insert, Delete
- Basic Select

---

### SQL for Database

> **ROUND :** `ROUND(*number*,¬†*decimals*,¬†*operation*)` ‡πÄ‡∏õ‡πá‡∏ô Function ‡∫Å‡∫≥‡∫ô‡∫ª‡∫î‡∫Ñ‡ªà‡∫≤‡∫Ç‡∫≠‡∫á‡∫ó‡∫ª‡∫î‡∫™‡∫∞‡∫ô‡∫¥‡∫ç‡∫ª‡∫°
> 
> 
> ```sql
> SELECT 
> 	name, 
> 	ROUND (Milliseconds/60000.0,2) as Minute,
> 	ROUND (Bytes / (1024*1024.0),2) as Mb
> FROM tracks
> ```
> 

---

> **Case When :**
> 
> 
> `CASE WHEN`¬†‡ªÉ‡∫ä‡ªâ‡ªÉ‡∫ô‡∫Å‡∫≤‡∫ô‡∫Ç‡∫Ω‡∫ô‡ªÄ‡∫á‡∫∑‡ªà‡∫≠‡∫ô‡ªÑ‡∫Ç ‡∫™‡ªâ‡∫≤‡∫á column ‡ªÉ‡∫´‡∫°‡ªà, ‡ªÄ‡∫Æ‡∫ª‡∫≤‡∫à‡∫∞‡∫Ç‡∫Ω‡∫ô¬†`CASE WHEN`¬†‡ªÉ‡∫ô¬†`SELECT`¬†clause
> 
> ‡ªÄ‡∫Æ‡∫ª‡∫≤‡∫™‡∫≤‡∫°‡∫≤‡∫î‡∫Ç‡∫Ω‡∫ô‡ªÑ‡∫î‡ªâ‡∫´‡∫º‡∫≤‡∫ç‡∫Å‡∫ß‡ªà‡∫≤‡ªú‡∫∂‡ªà‡∫á‡ªÄ‡∫á‡∫∑‡ªà‡∫≠‡∫ô‡ªÑ‡∫Ç ‡ªÑ‡∫î‡ªâ‡∫ú‡∫ª‡∫ô‡∫•‡∫±‡∫ö‡∫Ñ‡∫∑‡∫Å‡∫±‡∫ö¬†`=IFS()`¬†‡∫Ç‡∫≠‡∫á Google Sheets/ Excel
> 
> ```sql
> CASE
>     WHEN condition1 THEN result1
>     WHEN condition2 THEN result2
>     WHEN conditionN THEN resultN
>     ELSE result
> END;
> ```
> 
> ```sql
> SELECT 
> 	Company,
> 	CASE 
> 				WHEN Company is NOT NULL THEN 'Corporate'
> 				ELSE 'End customers'
> 			END as Segment
> FROM customers
> ```
> 

---

> **Working with DateTime**
> 
> 
> **CAST :** `CAST(*expression* AS¬†*datatype(length)*)` ‡ªÄ‡∫õ‡∫±‡∫ô Function ‡ªÉ‡∫ô‡∫Å‡∫≤‡∫ô‡∫Ç‡∫Ω‡∫ô Data type
> 
> ```sql
> SELECT 
> 	InvoiceDate,
> 	CAST (strftime('%Y',invoicedate) AS INT) as Year,
> 	strftime('%m',invoicedate) as Month,
> 	strftime('%d',invoicedate) as Day,
> 	strftime('%Y-%m',invoicedate) as Monthid
> FROM invoices
> WHERE Year = 2010
> ```
> 

---

> **JOIN by ID**
> 
> 
> ```sql
> SELECT 
> 	A.artistid,
> 	A.name,
> 	B.title
> FROM aertists AS A
> JOIN alblumns AS B
> ON A.artistid = B.artistid
> ```
> 
> ```sql
> SELECT * FROM artists
> JOIN albums on artists.ArtistId = albums.ArtistIdf
> ```
> 
> **Popular Join Inner Join and Left Join**
> 
> **Inner Join ‡∫à‡∫∞‡ªÄ‡∫õ‡∫±‡∫ô‡∫Å‡∫≤‡∫ô‡ªÄ‡∫≠‡∫ª‡∫≤‡∫™‡ªà‡∫ß‡∫ô‡∫ó‡∫µ‡ªà overlap ‡∫Å‡∫±‡∫ô‡∫°‡∫≤‡∫™‡∫∞‡ªÅ‡∫î‡∫á**
> 
> **Left Join** ‡∫à‡∫∞‡ªÄ‡∫≠‡∫ª‡∫≤‡∫™‡ªà‡∫ß‡∫ô‡∫ä‡ªâ‡∫≤‡∫ç‡ªÄ‡∫õ‡∫±‡∫ô‡∫´‡∫º‡∫±‡∫Å
> 
> Default Join in SQL is Inner join.
> 
> ![blog placeholder](https://res.cloudinary.com/dbm9vaatx/image/upload/v1727365574/qyta27nqjfbavkbgenyp.jpg)
> 
> **Join Multiple Table**
> 
> ```sql
> SELECT 
> 	Art.ArtistId,
> 	Art.name,
> 	Alb.Title,
> 	Tra.name,
> 	Tra.Composer
> FROM artists as Art
> JOIN albums as Alb
> on Art.ArtistId = Alb.ArtistId
> JOIN tracks as Tra
> on Alb.AlbumId = Tra.AlbumId
> ```
> 

---

> **Random Function**
> 
> 
> ```sql
> SELECT name, random() FROM tracks
> ORDER by random() DESC
> LIMIT 10
> ```
> 

**Using:**

- Round ‡ªÄ‡∫õ‡∫±‡∫ô Function ‡∫õ‡∫±‡∫î‡∫Ñ‡ªà‡∫≤‡∫ó‡∫ª‡∫î‡∫™‡∫∞‡∫ô‡∫¥‡∫ç‡∫ª‡∫°.
- Case When ‡ªÉ‡∫ä‡ªâ‡ªÉ‡∫ô‡∫Å‡∫≤‡∫ô‡∫™‡ªâ‡∫≤‡∫á‡ªÄ‡∫á‡∫∑‡ªà‡∫≠‡∫ô‡ªÑ‡∫Ç.
- Cast ‡ªÄ‡∫õ‡∫±‡∫ô Function ‡ªÉ‡∫ô‡∫Å‡∫≤‡∫ô‡∫Ç‡∫Ω‡∫ô Data type.
- JOIN ‡ªÄ‡∫õ‡∫±‡∫ô Function ‡ªÉ‡∫ô‡∫Å‡∫≤‡∫ô‡∫•‡∫ß‡∫° table ‡∫î‡ªâ‡∫ß‡∫ç‡ªÑ‡∫≠‡∫î‡∫µ
- Random Function ‡ªÅ‡∫•‡∫ô‡∫î‡ªâ‡∫≠‡∫°‡∫Ñ‡ªà‡∫≤

---

### SQL For Data Analyst 102

> **Filter in SQL**
> 
> 
> ```sql
> SELECT * FROM customers
> WHERE country = 'USA';
> 
> SELECT * FROM customers
> WHERE country = 'USA' AND state = 'CA';
> 
> SELECT * FROM customers
> WHERE country = 'USA' OR country = 'United Kingdom';
> 
> SELECT * FROM customers
> WHERE country IN ('USA', 'United Kingdom');
> 
> SELECT * FROM customers
> WHERE country NOT IN ('USA', 'United Kingdom');
> 
> SELECT * FROM customers `**wildcard '%' ‡∫Ñ‡∫∑‡∫ó‡∫µ‡ªà‡∫à‡∫∞ Match ‡∫Å‡∫±‡∫ö‡∫´‡∫ç‡∫±‡∫á‡∫Å‡ªç‡ªÑ‡∫î‡ªâ`**
> WHERE email LIKE '%@gmail.com';
> 
> SELECT * FROM customers
> WHERE email NOT LIKE '%gmail.com';
> 
> SELECT * FROM customers
> WHERE company IS NULL;
> 
> SELECT * FROM customers
> WHERE company IS NOT NULL;
> 
> SELECT * FROM customers
> WHERE customerid BETWEEN 10 AND 15; ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á ID ‡∏ó‡∏µ‡πà 10 ‡∏´‡∏≤ 15
> ```
> 

> **Coalesce : ‡ªÄ‡∫õ‡∫±‡∫ô Function ‡∫Å‡∫ß‡∫î‡∫à‡∫±‡∫ö‡∫Ñ‡ªà‡∫≤ Null ‡ªÅ‡∫•‡ªâ‡∫ß‡∫™‡∫≤‡∫°‡∫≤‡∫î‡ªÅ‡∫ó‡∫ô‡∫Ñ‡ªà‡∫≤‡∫≠‡∫∑‡ªà‡∫ô‡ªÜ‡ªÉ‡∫™‡ªà‡ªÑ‡∫î‡ªâ**
> 
> 
> ```sql
> SELECT 
> 	Company,
> 	**coalesce(Company,'End customer') as 'Company Clean'**,
> 	CASE WHEN Company is null then 'End customers'
> 				ELSE 'Corporate'
> 				END as 'Segment'
> FROM customers
> ```
> 

> ‡∫Å‡∫≤‡∫ô **Join table ‡∫î‡ªâ‡∫ß‡∫ç Where**
> 
> 
> ```sql
> SELECT 
> 	artists.ArtistId,
> 	artists.Name,
> 	albums.Title,
> 	tracks.Name
> FROM artists, albums, tracks
> WHERE artists.ArtistId = albums.ArtistId
> 	AND albums.AlbumId = tracks.AlbumId
> LIMIT 10
> ```
> 

## **Aggregate Functions**

Aggregate functions ‡∫Ñ‡∫∑‡∫ü‡∫±‡∫á‡∫ä‡∫±‡ªâ‡∫ô‡∫™‡∫∞‡∫ñ‡∫¥‡∫ï‡∫¥‡ªÄ‡∫ö‡∫∑‡ªâ‡∫≠‡∫á‡∫ï‡∫ª‡ªâ‡∫ô‡ªÑ‡∫ß‡ªâ‡∫™‡∫∞‡∫´‡∫º‡∫∏‡∫ö‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô, ‡∫ü‡∫±‡∫á‡∫ä‡∫±‡ªâ‡∫ô‡∫ó‡∫µ‡ªà‡ªÄ‡∫Æ‡∫ª‡∫≤‡ªÉ‡∫ä‡ªâ‡ªÄ‡∫õ‡∫±‡∫ô‡∫õ‡∫∞‡∫à‡∫≥‡ªÉ‡∫ô standard SQL ‡∫à‡∫∞‡∫°‡∫µ‡∫¢‡∫π‡ªà 5 functions ‡∫Ñ‡∫∑

- `COUNT` count(Milliseconds)
- `AVG` avg(Milliseconds)
- `SUM` sum(Milliseconds),
- `MIN` min(Milliseconds),
- `MAX`

***Aggregate functions ‡∫ö‡ªç‡ªà‡∫™‡∫ª‡∫ô‡ªÉ‡∫à‡∫Ñ‡ªà‡∫≤ Null ‡ªÉ‡∫ô‡∫Ñ‡ªç‡∫•‡ªâ‡∫≥‡∫ô‡∫±‡ªâ‡∫ô‡ªÜ**

> **DISTINCT** ‡ªÄ‡∫õ‡∫±‡∫ô Function ‡∫à‡∫≥‡ªÅ‡∫ô‡∫Å‡ªÅ‡∫ö‡∫ö Unique ‡∫™‡∫≤‡∫°‡∫≤‡∫î‡ªÉ‡∫ä‡ªâ‡∫Æ‡ªà‡∫ß‡∫°‡∫Å‡∫±‡∫ö Function count ‡ªÑ‡∫î‡ªâ
> 
> 
> ```sql
> SELECT count (DISTINCT Country)  FROM customers
> ```
> 

### Group By + Aggregate Functions

```sql
SELECT 
	genres.Name, 
	count(*) as count_songs
FROM genres, tracks
WHERE genres.GenreId = tracks.GenreId
GROUP by genres.Name
ORDER by count(*) DESC LIMIT 5SELECT 
	genres.Name, 
	count(*) as count_songs
FROM genres, tracks
WHERE genres.GenreId = tracks.GenreId
GROUP by genres.Name
```

### Having

`HAVING`¬†‡∫Ç‡∫Ω‡∫ô‡∫Ñ‡∫∑‡∫Å‡∫±‡∫ö¬†`WHERE`¬†clause

‡ªÅ‡∫ï‡ªà‡ªÄ‡∫Æ‡∫ª‡∫≤‡ªÉ‡∫ä‡ªâ¬†`HAVING`¬†‡ªÉ‡∫ô‡∫Å‡∫≤‡∫ô‡∫Å‡∫≠‡∫á‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô‡∫ó‡∫µ‡ªà‡∫ú‡ªà‡∫≤‡∫ô‡∫Å‡∫≤‡∫ô¬†`GROUP BY`¬†‡∫°‡∫≤‡ªÅ‡∫•‡ªâ‡∫ß üòÅ

‡ªÄ‡∫≠‡∫ª‡∫≤‡∫á‡ªà‡∫≤‡∫ç‡ªÜ‡∫Ñ‡∫∑‡∫Å‡∫≤‡∫ô‡∫Å‡∫≠‡∫á‡∫Ç‡ªç‡ªâ‡∫°‡∫π‡∫ô‡∫à‡∫≤‡∫Å‡∫Å‡∫∏‡ªà‡∫°‡∫ó‡∫µ‡ªà‡ªÄ‡∫Æ‡∫ª‡∫≤‡∫ï‡ªâ‡∫≠‡∫á‡∫Å‡∫≤‡∫ô‡∫ô‡∫±‡ªâ‡∫ô‡ªÄ‡∫≠‡∫á

```sql
SELECT 
	genres.Name, 
	count(*) as count_songs
FROM genres, tracks
WHERE genres.GenreId = tracks.GenreId AND genres.name **<>** 'Rock'. // <> = not= 
GROUP by genres.Name
HAVING count(*)>100
```

### Order by

```sql
SELECT 
	genres.Name, 
	count(*) as count_songs
FROM genres, tracks
WHERE genres.GenreId = tracks.GenreId
GROUP by genres.Name
ORDER by count(*) DESC LIMIT 5
```

- Filter in SQL using WHERE.
- Coalesce : ‡ªÄ‡∫õ‡∫±‡∫ô Function ‡∫Å‡∫ß‡∫î‡∫à‡∫±‡∫ö Null ‡ªÅ‡∫•‡ªâ‡∫ß‡∫™‡∫≤‡∫°‡∫≤‡∫î‡ªÅ‡∫ó‡∫ô‡∫Ñ‡ªà‡∫≤‡∫≠‡∫∑‡ªà‡∫ô‡ªÉ‡∫™‡ªà‡ªÑ‡∫î‡ªâ.
- Join table using Where.
- Aggregate Function (Count, AVG, SUM, MIN, MAX)
- Distinct ‡∫à‡∫≥‡ªÅ‡∫ô‡∫Å‡∫Ñ‡ªà‡∫≤ Unique
- Group by + Aggregate Function
- Having
- Order by

### SQL For Data Analyst 103

### Cross Join

![blog placeholder](/blog-placeholder-about.jpg)

### Self Join

![blog placeholder](/blog-placeholder-about.jpg)

### Intersect & Except

- **Intersect: returns distinct rows in both tables. (like INNER JOIN but not create new row)**
- **Except : return distinct rows in the first table, not presented in the second table.**
    
    ![blog placeholder](/blog-placeholder-about.jpg)
    

### Union

```sql
SELECT * FROM tableA
UNION (‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏≤‡∏™‡∏≠‡∏á table ‡∏°‡∏≤‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏Ñ‡πà‡∏≤ Dlubicate ‡∏≠‡∏≠‡∏Å)
SELECT * FROM tableB

```sql
SELECT * FROM tableA
UNION ALL (‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏≤‡∏™‡∏≠‡∏á table ‡∏°‡∏≤‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤ Dlubicate ‡πÑ‡∏ß‡πâ)
SELECT * FROM tableB
```
```

### Subqueries

```sql
SELECT FirstName , LastName, Country
FROM
	(	SELECT * 
	FROM customers
	WHERE Country = 'USA')
```

- Cross Join
- Self Join
- Intersect & Except
- Union
- Subqueries

---

### Live Class SQL

### Data analyst Workflow

> Query ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏´‡∏≤ Data base
> 

![blog placeholder](/blog-placeholder-about.jpg)

> ‡∏¢‡∏¥‡πà‡∏á‡∏£‡∏π‡πâ Business ‡∏¢‡∏¥‡πà‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Query ‡πÄ‡∏Å‡πà‡∏á
> 

> DataGrip can generate ER-diagram (pay)
> 

---

### **CRUD**

- CREATE
- RETRIEVE
- UPDATE
- DELETE


‡∏Ñ‡∏ß‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Where ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ

### subquery

```sql
-- outer query
SELECT 
				AVG(mb) AS avg_mb,
        SUM(mb) AS sum_mb,
        COUNT(mb) AS n_mb,
        COUNT(*)   AS n_row,
        MIN(mb) AS min_mb,
        MAX(mb) AS max_mb
FROM (
	-- inner query
	SELECT 
        bytes/ (1024*1024.0) AS mb
	FROM tracks
) AS sub;
```

```sql
-- Like funtion in c
WITH sub AS(
	SELECT * FROM customers
  	WHERE UPPER(country)= 'USA'
)

SELECT 
	firstname,
    lastname,
    country,
    email
FROM sub
```

Common table expression (With)

  

```jsx
with sub1 AS(
	SELECT * FROM customers
  	WHERE country = "USA"
), sub2 AS(
	SELECT * FROM invoices
  	where STRFTIME("%Y", invoicedate) = "2009"
)
SELECT 
	sub1.firstname,
    sub2.total
 FROM sub1
 JOIN sub2
 on sub1.customerid = sub2.customerid
```

```jsx
Create VIEW if not EXISTS usa_customers As 
	SELECT * FROM customers
  	WHERE country = "USA";
CREATE VIEW if NOT EXISTS invoice_2009 AS
	SELECT * FROM invoices
    where STRFTIME("%Y", invoicedate) = "2009";

SELECT * from usa_customers as a
JOIN invoice_2009 as b
on a.customerid = b.customerid
```